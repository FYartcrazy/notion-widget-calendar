<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfect Scalable Calendar</title>
    <style>
        /* --- НАСТРОЙКИ ЦВЕТОВ --- */
        :root {
            --theme-color: #035439; /* Темно-зеленый */
            --header-text: #ffffff; 
            --bg-color: #ffffff;
            --text-color: #37352f;
            --faded-text: #cccccc;
            --today-bg: #035439; 
            --today-text: #ffffff;
            --font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: var(--font);
            /* Скрываем всё, что вылезает за пределы */
            overflow: hidden; 
            background-color: transparent;
            /* Центрируем календарь в окне Notion */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            width: 100vw;
        }

        /* Это наш "Холст". Он имеет фиксированный размер. 
           Мы будем масштабировать именно этот блок целиком. */
        #calendar-wrapper {
            width: 340px;  /* Фиксированная ширина */
            height: 370px; /* Фиксированная высота */
            flex-shrink: 0; /* Запрещаем сжиматься стандартными методами */
            
            /* Стили самого календаря */
            background-color: var(--bg-color);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: rgba(15, 15, 15, 0.05) 0px 0px 0px 1px, rgba(15, 15, 15, 0.1) 0px 3px 6px, rgba(15, 15, 15, 0.2) 0px 9px 24px;
            display: flex;
            flex-direction: column;
            
            /* Точка масштабирования - центр */
            transform-origin: center center;
        }

        /* --- ВНУТРЕННОСТИ (Все размеры в px, так как мы масштабируем Wrapper целиком) --- */
        header {
            background-color: var(--theme-color);
            color: var(--header-text);
            padding: 12px 20px; 
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 50px; /* Фиксированная высота шапки */
            box-sizing: border-box;
        }

        #month-year {
            font-weight: 600;
            font-size: 1.1rem;
            letter-spacing: 0.5px;
        }

        .nav-btn {
            background: none;
            border: none;
            color: var(--header-text);
            font-size: 1.2rem;
            cursor: pointer;
            padding: 0 10px;
            font-family: monospace;
        }

        .body-wrapper {
            padding: 15px;
            border-bottom: 6px solid var(--theme-color); 
            flex-grow: 1;
            box-sizing: border-box;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(6, 1fr); /* Ровно 6 строк */
            gap: 4px;
            text-align: center;
            height: 100%; /* Занимаем всё доступное место */
        }

        .day-name {
            font-size: 0.75rem;
            color: var(--theme-color); 
            font-weight: 800; 
            text-transform: uppercase;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .day {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            border-radius: 8px;
            margin: 1px;
            cursor: default;
            color: var(--text-color);
        }

        .day.other-month {
            color: var(--faded-text);
        }

        .today {
            background-color: var(--today-bg);
            color: var(--today-text);
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div id="calendar-wrapper">
        <header>
            <button class="nav-btn" id="prev">&lt;</button>
            <div id="month-year"></div>
            <button class="nav-btn" id="next">&gt;</button>
        </header>
        
        <div class="body-wrapper">
            <div class="grid" id="calendar-grid"></div>
        </div>
    </div>

    <script>
        /* === ЛОГИКА КАЛЕНДАРЯ === */
        const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        const dayNamesShort = ["S", "M", "T", "W", "T", "F", "S"];

        let currentDate = new Date();
        let displayedDate = new Date();

        const monthYearEl = document.getElementById("month-year");
        const gridEl = document.getElementById("calendar-grid");
        const prevBtn = document.getElementById("prev");
        const nextBtn = document.getElementById("next");

        function renderCalendar() {
            const year = displayedDate.getFullYear();
            const month = displayedDate.getMonth();

            monthYearEl.innerText = `${monthNames[month]} ${year}`;
            gridEl.innerHTML = "";

            dayNamesShort.forEach(day => {
                const el = document.createElement("div");
                el.className = "day-name";
                el.innerText = day;
                gridEl.appendChild(el);
            });

            const firstDayIndex = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const prevLastDay = new Date(year, month, 0).getDate();

            for (let x = firstDayIndex; x > 0; x--) {
                const dayNum = prevLastDay - x + 1;
                const dayEl = document.createElement("div");
                dayEl.className = "day other-month";
                dayEl.innerText = dayNum;
                gridEl.appendChild(dayEl);
            }

            for (let i = 1; i <= daysInMonth; i++) {
                const dayEl = document.createElement("div");
                dayEl.className = "day";
                dayEl.innerText = i;
                
                if (i === currentDate.getDate() && 
                    month === currentDate.getMonth() && 
                    year === currentDate.getFullYear()) {
                    dayEl.classList.add("today");
                }
                gridEl.appendChild(dayEl);
            }

            const totalCellsFilled = firstDayIndex + daysInMonth;
            const cellsNeeded = 42 - totalCellsFilled;
            
            for (let j = 1; j <= cellsNeeded; j++) {
                const dayEl = document.createElement("div");
                dayEl.className = "day other-month";
                dayEl.innerText = j;
                gridEl.appendChild(dayEl);
            }
        }

        prevBtn.addEventListener("click", () => {
            displayedDate.setMonth(displayedDate.getMonth() - 1);
            renderCalendar();
        });

        nextBtn.addEventListener("click", () => {
            displayedDate.setMonth(displayedDate.getMonth() + 1);
            renderCalendar();
        });

        renderCalendar();

        /* === УМНОЕ МАСШТАБИРОВАНИЕ (FIT TO BOX) === */
        function fitToBox() {
            const wrapper = document.getElementById('calendar-wrapper');
            // Реальные размеры нашего календаря (из CSS)
            const baseWidth = 340;
            const baseHeight = 370;

            // Размеры окна, которое нам дал Notion
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;

            // Вычисляем, во сколько раз нужно уменьшить/увеличить
            // Math.min берет тот коэффициент, который меньше, чтобы календарь влез целиком
            // 0.9 - это небольшой отступ (10%), чтобы края не прилипали
            const scaleX = windowWidth / baseWidth;
            const scaleY = windowHeight / baseHeight;
            let scale = Math.min(scaleX, scaleY) * 0.95;

            // Применяем масштаб
            wrapper.style.transform = `scale(${scale})`;
        }

        // Следим за изменениями размера
        window.addEventListener('resize', fitToBox);
        window.addEventListener('load', fitToBox);
        // Запускаем постоянно, так как Notion может менять размеры плавно
        setInterval(fitToBox, 500);
        fitToBox();
    </script>
</body>
</html>

